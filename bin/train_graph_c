#!/usr/bin/env python
import multiprocessing
import argparse

import brick_gym.torch.train.graph_c as graph_c

parser = argparse.ArgumentParser()
parser.add_argument('--dataset', type=str, default='random_stack')
parser.add_argument('--train-split', type=str, default='train_mpd')
parser.add_argument('--test-split', type=str, default='test_mpd')
parser.add_argument('--train-subset', type=int, default=None)
parser.add_argument('--num-processes', type=int, default=16)
parser.add_argument('--learning-rate', type=float, default=3e-4)
parser.add_argument('--train-steps-per-epoch', type=int, default=4096)

if __name__ == '__main__':
    args = parser.parse_args()
    
    graph_c.train_label_confidence(
            1000,
            args.dataset,
            train_split=args.train_split,
            checkpoint_frequency=25,
            learning_rate=args.learning_rate,
            num_processes=args.num_processes,
            train_steps_per_epoch=args.train_steps_per_epoch)
